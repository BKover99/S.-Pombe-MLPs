2022-11-01 16:24:46 Hail: INFO: Running Hail version 0.2.104-1940d9e8eaab
2022-11-01 16:24:47 SparkContext: WARN: Using an existing SparkContext; some configuration may not take effect.
2022-11-01 16:24:56 root: ERROR: HailException: No file or directory found at data.mt
From is.hail.utils.HailException: No file or directory found at data.mt
	at is.hail.utils.ErrorHandling.fatal(ErrorHandling.scala:17)
	at is.hail.utils.ErrorHandling.fatal$(ErrorHandling.scala:17)
	at is.hail.utils.package$.fatal(package.scala:78)
	at is.hail.expr.ir.RelationalSpec$.readMetadata(AbstractMatrixTableSpec.scala:33)
	at is.hail.expr.ir.RelationalSpec$.readReferences(AbstractMatrixTableSpec.scala:74)
	at is.hail.variant.ReferenceGenome$.fromHailDataset(ReferenceGenome.scala:581)
	at is.hail.variant.ReferenceGenome.fromHailDataset(ReferenceGenome.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)



2022-11-01 16:25:08 root: INFO: RegionPool: initialized for thread 15: Thread-4
2022-11-01 16:25:08 root: INFO: globbing path /Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf returned 1 files: Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf
2022-11-01 16:25:08 root: INFO: globbing path file:/Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf returned 1 files: Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf
2022-11-01 16:25:08 MemoryStore: INFO: Block broadcast_0 stored as values in memory (estimated size 2.1 KiB, free 366.3 MiB)
2022-11-01 16:25:10 MemoryStore: INFO: Block broadcast_0_piece0 stored as bytes in memory (estimated size 548.0 B, free 366.3 MiB)
2022-11-01 16:25:10 BlockManagerInfo: INFO: Added broadcast_0_piece0 in memory on eduroam-int-dhcp-97-180-2.ucl.ac.uk:63767 (size: 548.0 B, free: 366.3 MiB)
2022-11-01 16:25:10 SparkContext: INFO: Created broadcast 0 from broadcast at SparkBackend.scala:342
2022-11-01 16:25:10 root: INFO: RegionPool: FREE: 64.0K allocated (64.0K blocks / 0 chunks), regions.size = 1, 0 current java objects, thread 15: Thread-4
2022-11-01 16:25:10 root: INFO: timing SparkBackend.parse_matrix_ir total 1.813s self 1.813s children 0.000ms %children 0.00%
2022-11-01 16:25:10 root: INFO: RegionPool: initialized for thread 15: Thread-4
2022-11-01 16:25:10 root: INFO: RegionPool: FREE: 64.0K allocated (64.0K blocks / 0 chunks), regions.size = 1, 0 current java objects, thread 15: Thread-4
2022-11-01 16:25:10 root: INFO: timing SparkBackend.parse_value_ir total 47.208ms self 47.208ms children 0.000ms %children 0.00%
2022-11-01 16:25:10 root: INFO: RegionPool: initialized for thread 15: Thread-4
2022-11-01 16:25:10 root: INFO: starting execution of query hail_query_4 of initial size 4
2022-11-01 16:25:10 root: INFO: optimize optimize: relationalLowerer, initial IR: before: IR size 4: 
(Let __rng_state
  (RNGStateLiteral (0 0 0 0))
  (MatrixWrite
    "{\"name\":\"MatrixNativeWriter\",\"path\":\"data.mt\",\"overwrite\":true,\"stageLocally\":false,\"codecSpecJSONStr\":null,\"partitions\":null,\"partitionsTypeStr\":null,\"checkpointFile\":null}"
    (MatrixRead
      Matrix{global:Struct{},col_key:[s],col:Struct{s:String},row_key:[[locus,alleles]],row:Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],rsid:String,qual:Float64,filters:Set[String],info:Struct{AF:Array[Float64],BaseQRankSum:Float64,DP:Int32,DS:Boolean,Dels:Float64,FS:Float64,HaplotypeScore:Float64,InbreedingCoeff:Float64,MLEAC:Array[Int32],MLEAF:Array[Float64],MQ:Float64,MQ0:Int32,MQRankSum:Float64,QD:Float64,RPA:Array[Int32],RU:String,ReadPosRankSum:Float64,SB:Array[Float64],STR:Boolean,SF:Array[String],AC:Array[Int32],AN:Int32,`MM.RNA.CPC`:Array[Float64],`MN.RNA.CPC`:Float64,`MM.PROT.CPC`:Array[Float64],`MN.PROT.CPC`:Array[Float64],`MAX.RNA.CPC`:Array[Float64],`MAX.PROT.CPC`:Array[Float64],`SUM.RNA.CPC`:Array[Float64],`SUM.PROT.CPC`:Array[Float64],`MED.RNA.CPC`:Array[Float64],`MED.PROT.CPC`:Array[Float64],CPCFRAC:Array[Float64],GENETYPE:Array[String],PHASE:Array[String],DEGENCODE:Array[String],DEGEN:Array[String],AMINO:Array[String],CODON:Array[String],GENE:Array[String],ANNO:Array[String],EFF:Array[String]}},entry:Struct{AD:Array[Int32],DP:Int32,GQ:Int32,GT:Call,FT:String,MLPSAC:Array[Int32],MLPSAF:Array[Float64],PL:Array[Int32]}}
      False False
      {\"files\":[\"/Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf\"],\"callFields\":[\"PGT\"],\"entryFloatTypeName\":\"Float64\",\"rg\":\"Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa\",\"contigRecoding\":{},\"arrayElementsRequired\":true,\"skipInvalidLoci\":false,\"gzAsBGZ\":false,\"forceGZ\":false,\"filterAndReplace\":{},\"partitionsJSON\":null,\"name\":\"MatrixVCFReader\"})))
2022-11-01 16:25:10 root: INFO: optimize optimize: relationalLowerer, initial IR: after: IR size 2:
(MatrixWrite
  "{\"name\":\"MatrixNativeWriter\",\"path\":\"data.mt\",\"overwrite\":true,\"stageLocally\":false,\"codecSpecJSONStr\":null,\"partitions\":null,\"partitionsTypeStr\":null,\"checkpointFile\":null}"
  (MatrixRead
    Matrix{global:Struct{},col_key:[s],col:Struct{s:String},row_key:[[locus,alleles]],row:Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],rsid:String,qual:Float64,filters:Set[String],info:Struct{AF:Array[Float64],BaseQRankSum:Float64,DP:Int32,DS:Boolean,Dels:Float64,FS:Float64,HaplotypeScore:Float64,InbreedingCoeff:Float64,MLEAC:Array[Int32],MLEAF:Array[Float64],MQ:Float64,MQ0:Int32,MQRankSum:Float64,QD:Float64,RPA:Array[Int32],RU:String,ReadPosRankSum:Float64,SB:Array[Float64],STR:Boolean,SF:Array[String],AC:Array[Int32],AN:Int32,`MM.RNA.CPC`:Array[Float64],`MN.RNA.CPC`:Float64,`MM.PROT.CPC`:Array[Float64],`MN.PROT.CPC`:Array[Float64],`MAX.RNA.CPC`:Array[Float64],`MAX.PROT.CPC`:Array[Float64],`SUM.RNA.CPC`:Array[Float64],`SUM.PROT.CPC`:Array[Float64],`MED.RNA.CPC`:Array[Float64],`MED.PROT.CPC`:Array[Float64],CPCFRAC:Array[Float64],GENETYPE:Array[String],PHASE:Array[String],DEGENCODE:Array[String],DEGEN:Array[String],AMINO:Array[String],CODON:Array[String],GENE:Array[String],ANNO:Array[String],EFF:Array[String]}},entry:Struct{AD:Array[Int32],DP:Int32,GQ:Int32,GT:Call,FT:String,MLPSAC:Array[Int32],MLPSAF:Array[Float64],PL:Array[Int32]}}
    False False
    {\"files\":[\"/Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf\"],\"callFields\":[\"PGT\"],\"entryFloatTypeName\":\"Float64\",\"rg\":\"Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa\",\"contigRecoding\":{},\"arrayElementsRequired\":true,\"skipInvalidLoci\":false,\"gzAsBGZ\":false,\"forceGZ\":false,\"filterAndReplace\":{},\"partitionsJSON\":null,\"name\":\"MatrixVCFReader\"}))
2022-11-01 16:25:10 root: INFO: optimize optimize: relationalLowerer, after LowerMatrixToTable: before: IR size 2: 
(TableWrite
  "{\"writer\":{\"path\":\"data.mt\",\"overwrite\":true,\"stageLocally\":false,\"codecSpecJSONStr\":null,\"partitions\":null,\"partitionsTypeStr\":null,\"checkpointFile\":null},\"colsFieldName\":\"__cols\",\"entriesFieldName\":\"the entries! [877f12a8827e18f61222c6c8c5fb04a8]\",\"colKey\":[\"s\"]}"
  (TableRead
    Table{global:Struct{__cols:Array[Struct{s:String}]},key:[locus,alleles],row:Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],rsid:String,qual:Float64,filters:Set[String],info:Struct{AF:Array[Float64],BaseQRankSum:Float64,DP:Int32,DS:Boolean,Dels:Float64,FS:Float64,HaplotypeScore:Float64,InbreedingCoeff:Float64,MLEAC:Array[Int32],MLEAF:Array[Float64],MQ:Float64,MQ0:Int32,MQRankSum:Float64,QD:Float64,RPA:Array[Int32],RU:String,ReadPosRankSum:Float64,SB:Array[Float64],STR:Boolean,SF:Array[String],AC:Array[Int32],AN:Int32,`MM.RNA.CPC`:Array[Float64],`MN.RNA.CPC`:Float64,`MM.PROT.CPC`:Array[Float64],`MN.PROT.CPC`:Array[Float64],`MAX.RNA.CPC`:Array[Float64],`MAX.PROT.CPC`:Array[Float64],`SUM.RNA.CPC`:Array[Float64],`SUM.PROT.CPC`:Array[Float64],`MED.RNA.CPC`:Array[Float64],`MED.PROT.CPC`:Array[Float64],CPCFRAC:Array[Float64],GENETYPE:Array[String],PHASE:Array[String],DEGENCODE:Array[String],DEGEN:Array[String],AMINO:Array[String],CODON:Array[String],GENE:Array[String],ANNO:Array[String],EFF:Array[String]},`the entries! [877f12a8827e18f61222c6c8c5fb04a8]`:Array[Struct{AD:Array[Int32],DP:Int32,GQ:Int32,GT:Call,FT:String,MLPSAC:Array[Int32],MLPSAF:Array[Float64],PL:Array[Int32]}]}}
    False
    {\"files\":[\"/Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf\"],\"callFields\":[\"PGT\"],\"entryFloatTypeName\":\"Float64\",\"rg\":\"Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa\",\"contigRecoding\":{},\"arrayElementsRequired\":true,\"skipInvalidLoci\":false,\"gzAsBGZ\":false,\"forceGZ\":false,\"filterAndReplace\":{},\"partitionsJSON\":null,\"name\":\"MatrixVCFReader\"}))
2022-11-01 16:25:10 root: INFO: optimize optimize: relationalLowerer, after LowerMatrixToTable: after: IR size 2:
(TableWrite
  "{\"writer\":{\"path\":\"data.mt\",\"overwrite\":true,\"stageLocally\":false,\"codecSpecJSONStr\":null,\"partitions\":null,\"partitionsTypeStr\":null,\"checkpointFile\":null},\"colsFieldName\":\"__cols\",\"entriesFieldName\":\"the entries! [877f12a8827e18f61222c6c8c5fb04a8]\",\"colKey\":[\"s\"]}"
  (TableRead
    Table{global:Struct{__cols:Array[Struct{s:String}]},key:[locus,alleles],row:Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],rsid:String,qual:Float64,filters:Set[String],info:Struct{AF:Array[Float64],BaseQRankSum:Float64,DP:Int32,DS:Boolean,Dels:Float64,FS:Float64,HaplotypeScore:Float64,InbreedingCoeff:Float64,MLEAC:Array[Int32],MLEAF:Array[Float64],MQ:Float64,MQ0:Int32,MQRankSum:Float64,QD:Float64,RPA:Array[Int32],RU:String,ReadPosRankSum:Float64,SB:Array[Float64],STR:Boolean,SF:Array[String],AC:Array[Int32],AN:Int32,`MM.RNA.CPC`:Array[Float64],`MN.RNA.CPC`:Float64,`MM.PROT.CPC`:Array[Float64],`MN.PROT.CPC`:Array[Float64],`MAX.RNA.CPC`:Array[Float64],`MAX.PROT.CPC`:Array[Float64],`SUM.RNA.CPC`:Array[Float64],`SUM.PROT.CPC`:Array[Float64],`MED.RNA.CPC`:Array[Float64],`MED.PROT.CPC`:Array[Float64],CPCFRAC:Array[Float64],GENETYPE:Array[String],PHASE:Array[String],DEGENCODE:Array[String],DEGEN:Array[String],AMINO:Array[String],CODON:Array[String],GENE:Array[String],ANNO:Array[String],EFF:Array[String]},`the entries! [877f12a8827e18f61222c6c8c5fb04a8]`:Array[Struct{AD:Array[Int32],DP:Int32,GQ:Int32,GT:Call,FT:String,MLPSAC:Array[Int32],MLPSAF:Array[Float64],PL:Array[Int32]}]}}
    False
    {\"files\":[\"/Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/external data/Jeffares/Jeffares SNPs/ERZ289255/Spombe.2013-01-02.filt3c.nr57-final.snps.anno-snpeff3.cleaned4.vcf\"],\"callFields\":[\"PGT\"],\"entryFloatTypeName\":\"Float64\",\"rg\":\"Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa\",\"contigRecoding\":{},\"arrayElementsRequired\":true,\"skipInvalidLoci\":false,\"gzAsBGZ\":false,\"forceGZ\":false,\"filterAndReplace\":{},\"partitionsJSON\":null,\"name\":\"MatrixVCFReader\"}))
2022-11-01 16:25:10 root: INFO: LowerOrInterpretNonCompilable: whole stage code generation is a go!
2022-11-01 16:25:10 root: INFO: lowering result: TableWrite
2022-11-01 16:25:10 Hail: INFO: scanning VCF for sortedness...
2022-11-01 16:25:10 root: INFO: optimize optimize: compileLowerer, initial IR: before: IR size 169: 
(Let sortedPartData
  (ArraySort __iruid_620 __iruid_621
    (Let __iruid_616
      (CollectDistributedArray table_coerce_sortedness
        context globals
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (MakeStruct)
        (StreamAgg x
          (StreamAggScan key
            (ReadPartition
              Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
              "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
              (Ref context))
            (MakeStruct
              (key (Ref key))
              (token
                (ApplySeeded rand_unif 1 Float64
                  (F64 0.0)
                  (F64 1.0)
                  (NA RNGState)))
              (prevkey
                (ApplyScanOp PrevNonnull () ((Ref key))))))
          (Let n
            (ApplyAggOp Count () ())
            (AggLet key False
              (GetField key (Ref x))
              (MakeStruct
                (n (Ref n))
                (minkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref key) (Ref key))))
                (maxkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref key) (Ref key))))
                (ksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref x)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref x))
                              (GetField key (Ref x)))))))
                    (Ref n)))
                (pksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields (locus) (GetField prevkey (Ref x))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus) (GetField prevkey (Ref x)))
                              (SelectFields (locus) (GetField key (Ref x))))))))
                    (Ref n)))
                (sample
                  (ApplyAggOp TakeBy
                    ((I32 20))
                    ((GetField key (Ref x))
                      (GetField token (Ref x)))))))))
        (NA String))
      (StreamMap __iruid_619
        (StreamFilter __iruid_618
          (StreamMap __iruid_617
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_616))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_616) (Ref __iruid_617))
              None
              (i (Ref __iruid_617))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_618)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_619)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_619))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_619))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_620))
      (SelectFields (minkey maxkey) (Ref __iruid_621))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold acc partDataWithIndex
          (ToStream False (Ref sortedPartData))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref acc)
            (GetField ksorted (Ref partDataWithIndex))))
        (StreamFold acc i
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref sortedPartData))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref acc)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref sortedPartData) (Ref i)))
              (GetField minkey
                (ArrayRef -1
                  (Ref sortedPartData)
                  (ApplyBinaryPrimOp Add (Ref i) (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold acc partDataWithIndex
          (ToStream False (Ref sortedPartData))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref acc)
            (GetField pksorted (Ref partDataWithIndex))))
        (StreamFold acc i
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref sortedPartData))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref acc)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1 (Ref sortedPartData) (Ref i))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref sortedPartData)
                    (ApplyBinaryPrimOp Add (Ref i) (I32 1))))))))))
    (sortedPartData (Ref sortedPartData))))
2022-11-01 16:25:11 root: INFO: optimize optimize: compileLowerer, initial IR: after: IR size 169:
(Let __iruid_664
  (ArraySort __iruid_665 __iruid_666
    (Let __iruid_667
      (CollectDistributedArray table_coerce_sortedness
        __iruid_668 __iruid_669
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (Literal Struct{} <literal value>)
        (StreamAgg __iruid_670
          (StreamAggScan __iruid_671
            (ReadPartition
              Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
              "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
              (Ref __iruid_668))
            (MakeStruct
              (key (Ref __iruid_671))
              (token
                (ApplySeeded rand_unif 1 Float64
                  (F64 0.0)
                  (F64 1.0)
                  (NA RNGState)))
              (prevkey
                (ApplyScanOp PrevNonnull
                  ()
                  ((Ref __iruid_671))))))
          (Let __iruid_672
            (ApplyAggOp Count () ())
            (AggLet __iruid_673 False
              (GetField key (Ref __iruid_670))
              (MakeStruct
                (n (Ref __iruid_672))
                (minkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_673) (Ref __iruid_673))))
                (maxkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_673) (Ref __iruid_673))))
                (ksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref __iruid_670)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref __iruid_670))
                              (GetField key (Ref __iruid_670)))))))
                    (Ref __iruid_672)))
                (pksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields ()
                                (GetField prevkey (Ref __iruid_670))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus)
                                (GetField prevkey (Ref __iruid_670)))
                              (SelectFields (locus)
                                (GetField key (Ref __iruid_670))))))))
                    (Ref __iruid_672)))
                (sample
                  (ApplyAggOp TakeBy
                    ((I32 20))
                    ((GetField key (Ref __iruid_670))
                      (GetField token (Ref __iruid_670)))))))))
        (NA String))
      (StreamMap __iruid_674
        (StreamFilter __iruid_675
          (StreamMap __iruid_676
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_667))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_667) (Ref __iruid_676))
              None
              (i (Ref __iruid_676))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_675)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_674)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_674))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_674))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_665))
      (SelectFields (minkey maxkey) (Ref __iruid_666))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_677 __iruid_678
          (ToStream False (Ref __iruid_664))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_677)
            (GetField ksorted (Ref __iruid_678))))
        (StreamFold __iruid_679 __iruid_680
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_664))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_679)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref __iruid_664) (Ref __iruid_680)))
              (GetField minkey
                (ArrayRef -1
                  (Ref __iruid_664)
                  (ApplyBinaryPrimOp Add
                    (Ref __iruid_680)
                    (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_681 __iruid_682
          (ToStream False (Ref __iruid_664))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_681)
            (GetField pksorted (Ref __iruid_682))))
        (StreamFold __iruid_683 __iruid_684
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_664))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_683)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1
                    (Ref __iruid_664)
                    (Ref __iruid_684))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref __iruid_664)
                    (ApplyBinaryPrimOp Add
                      (Ref __iruid_684)
                      (I32 1))))))))))
    (sortedPartData (Ref __iruid_664))))
2022-11-01 16:25:11 root: INFO: optimize optimize: compileLowerer, after InlineApplyIR: before: IR size 169: 
(Let __iruid_664
  (ArraySort __iruid_665 __iruid_666
    (Let __iruid_667
      (CollectDistributedArray table_coerce_sortedness
        __iruid_668 __iruid_669
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (Literal Struct{} <literal value>)
        (StreamAgg __iruid_670
          (StreamAggScan __iruid_671
            (ReadPartition
              Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
              "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
              (Ref __iruid_668))
            (MakeStruct
              (key (Ref __iruid_671))
              (token
                (ApplySeeded rand_unif 1 Float64
                  (F64 0.0)
                  (F64 1.0)
                  (NA RNGState)))
              (prevkey
                (ApplyScanOp PrevNonnull
                  ()
                  ((Ref __iruid_671))))))
          (Let __iruid_672
            (ApplyAggOp Count () ())
            (AggLet __iruid_673 False
              (GetField key (Ref __iruid_670))
              (MakeStruct
                (n (Ref __iruid_672))
                (minkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_673) (Ref __iruid_673))))
                (maxkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_673) (Ref __iruid_673))))
                (ksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref __iruid_670)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref __iruid_670))
                              (GetField key (Ref __iruid_670)))))))
                    (Ref __iruid_672)))
                (pksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields ()
                                (GetField prevkey (Ref __iruid_670))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus)
                                (GetField prevkey (Ref __iruid_670)))
                              (SelectFields (locus)
                                (GetField key (Ref __iruid_670))))))))
                    (Ref __iruid_672)))
                (sample
                  (ApplyAggOp TakeBy
                    ((I32 20))
                    ((GetField key (Ref __iruid_670))
                      (GetField token (Ref __iruid_670)))))))))
        (NA String))
      (StreamMap __iruid_674
        (StreamFilter __iruid_675
          (StreamMap __iruid_676
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_667))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_667) (Ref __iruid_676))
              None
              (i (Ref __iruid_676))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_675)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_674)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_674))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_674))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_665))
      (SelectFields (minkey maxkey) (Ref __iruid_666))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_677 __iruid_678
          (ToStream False (Ref __iruid_664))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_677)
            (GetField ksorted (Ref __iruid_678))))
        (StreamFold __iruid_679 __iruid_680
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_664))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_679)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref __iruid_664) (Ref __iruid_680)))
              (GetField minkey
                (ArrayRef -1
                  (Ref __iruid_664)
                  (ApplyBinaryPrimOp Add
                    (Ref __iruid_680)
                    (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_681 __iruid_682
          (ToStream False (Ref __iruid_664))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_681)
            (GetField pksorted (Ref __iruid_682))))
        (StreamFold __iruid_683 __iruid_684
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_664))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_683)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1
                    (Ref __iruid_664)
                    (Ref __iruid_684))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref __iruid_664)
                    (ApplyBinaryPrimOp Add
                      (Ref __iruid_684)
                      (I32 1))))))))))
    (sortedPartData (Ref __iruid_664))))
2022-11-01 16:25:11 root: INFO: optimize optimize: compileLowerer, after InlineApplyIR: after: IR size 169:
(Let __iruid_727
  (ArraySort __iruid_728 __iruid_729
    (Let __iruid_730
      (CollectDistributedArray table_coerce_sortedness
        __iruid_731 __iruid_732
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (Literal Struct{} <literal value>)
        (StreamAgg __iruid_733
          (StreamAggScan __iruid_734
            (ReadPartition
              Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
              "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
              (Ref __iruid_731))
            (MakeStruct
              (key (Ref __iruid_734))
              (token
                (ApplySeeded rand_unif 1 Float64
                  (F64 0.0)
                  (F64 1.0)
                  (NA RNGState)))
              (prevkey
                (ApplyScanOp PrevNonnull
                  ()
                  ((Ref __iruid_734))))))
          (Let __iruid_735
            (ApplyAggOp Count () ())
            (AggLet __iruid_736 False
              (GetField key (Ref __iruid_733))
              (MakeStruct
                (n (Ref __iruid_735))
                (minkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_736) (Ref __iruid_736))))
                (maxkey
                  (ApplyAggOp TakeBy
                    ((I32 1))
                    ((Ref __iruid_736) (Ref __iruid_736))))
                (ksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref __iruid_733)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref __iruid_733))
                              (GetField key (Ref __iruid_733)))))))
                    (Ref __iruid_735)))
                (pksorted
                  (ApplyComparisonOp EQ
                    (ApplyAggOp Sum
                      ()
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields ()
                                (GetField prevkey (Ref __iruid_733))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus)
                                (GetField prevkey (Ref __iruid_733)))
                              (SelectFields (locus)
                                (GetField key (Ref __iruid_733))))))))
                    (Ref __iruid_735)))
                (sample
                  (ApplyAggOp TakeBy
                    ((I32 20))
                    ((GetField key (Ref __iruid_733))
                      (GetField token (Ref __iruid_733)))))))))
        (NA String))
      (StreamMap __iruid_737
        (StreamFilter __iruid_738
          (StreamMap __iruid_739
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_730))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_730) (Ref __iruid_739))
              None
              (i (Ref __iruid_739))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_738)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_737)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_737))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_737))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_728))
      (SelectFields (minkey maxkey) (Ref __iruid_729))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_740 __iruid_741
          (ToStream False (Ref __iruid_727))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_740)
            (GetField ksorted (Ref __iruid_741))))
        (StreamFold __iruid_742 __iruid_743
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_727))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_742)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref __iruid_727) (Ref __iruid_743)))
              (GetField minkey
                (ArrayRef -1
                  (Ref __iruid_727)
                  (ApplyBinaryPrimOp Add
                    (Ref __iruid_743)
                    (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_744 __iruid_745
          (ToStream False (Ref __iruid_727))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_744)
            (GetField pksorted (Ref __iruid_745))))
        (StreamFold __iruid_746 __iruid_747
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_727))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_746)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1
                    (Ref __iruid_727)
                    (Ref __iruid_747))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref __iruid_727)
                    (ApplyBinaryPrimOp Add
                      (Ref __iruid_747)
                      (I32 1))))))))))
    (sortedPartData (Ref __iruid_727))))
2022-11-01 16:25:12 root: INFO: optimize optimize: compileLowerer, after LowerArrayAggsToRunAggs: before: IR size 207: 
(Let __iruid_727
  (ArraySort __iruid_728 __iruid_729
    (Let __iruid_730
      (CollectDistributedArray table_coerce_sortedness
        __iruid_731 __iruid_732
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (Literal Struct{} <literal value>)
        (Let __iruid_749
          (RunAgg ((TypedStateSig +PInt64)
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})
              (TypedStateSig +PInt64)
              (TypedStateSig +PInt64)
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PFloat64))
            (Begin
              (Begin
                (InitOp 0 (Count (TypedStateSig +PInt64)) ())
                (InitOp 1 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  ((I32 1)))
                (InitOp 2 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  ((I32 1)))
                (InitOp 3 (Sum (TypedStateSig +PInt64)) ())
                (InitOp 4 (Sum (TypedStateSig +PInt64)) ())
                (InitOp 5 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PFloat64))
                  ((I32 20))))
              (StreamFor __iruid_733
                (RunAggScan __iruid_734 (
                    (TypedStateSig
                      PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  (ReadPartition
                    Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
                    "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
                    (Ref __iruid_731))
                  (Begin
                    (InitOp 0 
                      (PrevNonnull 
                        (TypedStateSig
                          PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ()))
                  (Begin
                    (SeqOp 0 
                      (PrevNonnull 
                        (TypedStateSig
                          PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_734))))
                  (Let __iruid_748
                    (MakeTuple (0)
                      (ResultOp 0 
                        (PrevNonnull 
                          (TypedStateSig
                            PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))))
                    (MakeStruct
                      (key (Ref __iruid_734))
                      (token
                        (ApplySeeded rand_unif 1 Float64
                          (F64 0.0)
                          (F64 1.0)
                          (NA RNGState)))
                      (prevkey (GetTupleElement 0 (Ref __iruid_748))))))
                (Let __iruid_736
                  (GetField key (Ref __iruid_733))
                  (Begin
                    (SeqOp 0 (Count (TypedStateSig +PInt64)) ())
                    (SeqOp 1 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_736) (Ref __iruid_736)))
                    (SeqOp 2 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_736) (Ref __iruid_736)))
                    (SeqOp 3 (Sum (TypedStateSig +PInt64))
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref __iruid_733)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref __iruid_733))
                              (GetField key (Ref __iruid_733)))))))
                    (SeqOp 4 (Sum (TypedStateSig +PInt64))
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields ()
                                (GetField prevkey (Ref __iruid_733))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus)
                                (GetField prevkey (Ref __iruid_733)))
                              (SelectFields (locus)
                                (GetField key (Ref __iruid_733))))))))
                    (SeqOp 5 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PFloat64))
                      ((GetField key (Ref __iruid_733))
                        (GetField token (Ref __iruid_733))))))))
            (MakeTuple (0 1 2 3 4 5)
              (ResultOp 0 (Count (TypedStateSig +PInt64)))
              (ResultOp 1 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})))
              (ResultOp 2 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})))
              (ResultOp 3 (Sum (TypedStateSig +PInt64)))
              (ResultOp 4 (Sum (TypedStateSig +PInt64)))
              (ResultOp 5 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PFloat64)))))
          (Let __iruid_735
            (GetTupleElement 0 (Ref __iruid_749))
            (MakeStruct
              (n (Ref __iruid_735))
              (minkey (GetTupleElement 1 (Ref __iruid_749)))
              (maxkey (GetTupleElement 2 (Ref __iruid_749)))
              (ksorted
                (ApplyComparisonOp EQ
                  (GetTupleElement 3 (Ref __iruid_749))
                  (Ref __iruid_735)))
              (pksorted
                (ApplyComparisonOp EQ
                  (GetTupleElement 4 (Ref __iruid_749))
                  (Ref __iruid_735)))
              (sample (GetTupleElement 5 (Ref __iruid_749))))))
        (NA String))
      (StreamMap __iruid_737
        (StreamFilter __iruid_738
          (StreamMap __iruid_739
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_730))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_730) (Ref __iruid_739))
              None
              (i (Ref __iruid_739))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_738)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_737)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_737))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_737))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_728))
      (SelectFields (minkey maxkey) (Ref __iruid_729))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_740 __iruid_741
          (ToStream False (Ref __iruid_727))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_740)
            (GetField ksorted (Ref __iruid_741))))
        (StreamFold __iruid_742 __iruid_743
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_727))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_742)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref __iruid_727) (Ref __iruid_743)))
              (GetField minkey
                (ArrayRef -1
                  (Ref __iruid_727)
                  (ApplyBinaryPrimOp Add
                    (Ref __iruid_743)
                    (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_744 __iruid_745
          (ToStream False (Ref __iruid_727))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_744)
            (GetField pksorted (Ref __iruid_745))))
        (StreamFold __iruid_746 __iruid_747
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_727))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_746)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1
                    (Ref __iruid_727)
                    (Ref __iruid_747))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref __iruid_727)
                    (ApplyBinaryPrimOp Add
                      (Ref __iruid_747)
                      (I32 1))))))))))
    (sortedPartData (Ref __iruid_727))))
2022-11-01 16:25:13 root: INFO: optimize optimize: compileLowerer, after LowerArrayAggsToRunAggs: after: IR size 207:
(Let __iruid_796
  (ArraySort __iruid_797 __iruid_798
    (Let __iruid_799
      (CollectDistributedArray table_coerce_sortedness
        __iruid_800 __iruid_801
        (ToStream False
          (Literal
            Array[Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}]
            <literal value>))
        (Literal Struct{} <literal value>)
        (Let __iruid_802
          (RunAgg ((TypedStateSig +PInt64)
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})
              (TypedStateSig +PInt64)
              (TypedStateSig +PInt64)
              
              (TakeByStateSig
                +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                +PFloat64))
            (Begin
              (Begin
                (InitOp 0 (Count (TypedStateSig +PInt64)) ())
                (InitOp 1 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  ((I32 1)))
                (InitOp 2 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  ((I32 1)))
                (InitOp 3 (Sum (TypedStateSig +PInt64)) ())
                (InitOp 4 (Sum (TypedStateSig +PInt64)) ())
                (InitOp 5 
                  (TakeBy 
                    (TakeByStateSig
                      +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                      +PFloat64))
                  ((I32 20))))
              (StreamFor __iruid_803
                (RunAggScan __iruid_804 (
                    (TypedStateSig
                      PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                  (ReadPartition
                    Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String]}
                    "{\"category\":\"PartitionIteratorLongReader\",\"fullRowType\":\"Struct{locus:Locus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:Array[String],__row_uid:Tuple[Int64,Int64]}\",\"uidFieldName\":\"__row_uid\",\"contextType\":\"Struct{partitionIndex:Int32,fileNum:Int32,file:String,start:Int64,end:Int64,split:Boolean}\"}"
                    (Ref __iruid_800))
                  (Begin
                    (InitOp 0 
                      (PrevNonnull 
                        (TypedStateSig
                          PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ()))
                  (Begin
                    (SeqOp 0 
                      (PrevNonnull 
                        (TypedStateSig
                          PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_804))))
                  (Let __iruid_805
                    (MakeTuple (0)
                      (ResultOp 0 
                        (PrevNonnull 
                          (TypedStateSig
                            PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))))
                    (MakeStruct
                      (key (Ref __iruid_804))
                      (token
                        (ApplySeeded rand_unif 1 Float64
                          (F64 0.0)
                          (F64 1.0)
                          (NA RNGState)))
                      (prevkey (GetTupleElement 0 (Ref __iruid_805))))))
                (Let __iruid_806
                  (GetField key (Ref __iruid_803))
                  (Begin
                    (SeqOp 0 (Count (TypedStateSig +PInt64)) ())
                    (SeqOp 1 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_806) (Ref __iruid_806)))
                    (SeqOp 2 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}))
                      ((Ref __iruid_806) (Ref __iruid_806)))
                    (SeqOp 3 (Sum (TypedStateSig +PInt64))
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA (GetField prevkey (Ref __iruid_803)))
                            (ApplyComparisonOp LTEQ
                              (GetField prevkey (Ref __iruid_803))
                              (GetField key (Ref __iruid_803)))))))
                    (SeqOp 4 (Sum (TypedStateSig +PInt64))
                      ((Apply -1 toInt64 () Int64
                          (ApplySpecial -1 lor () Boolean
                            (IsNA
                              (SelectFields ()
                                (GetField prevkey (Ref __iruid_803))))
                            (ApplyComparisonOp LTEQ
                              (SelectFields (locus)
                                (GetField prevkey (Ref __iruid_803)))
                              (SelectFields (locus)
                                (GetField key (Ref __iruid_803))))))))
                    (SeqOp 5 
                      (TakeBy 
                        (TakeByStateSig
                          +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                          +PFloat64))
                      ((GetField key (Ref __iruid_803))
                        (GetField token (Ref __iruid_803))))))))
            (MakeTuple (0 1 2 3 4 5)
              (ResultOp 0 (Count (TypedStateSig +PInt64)))
              (ResultOp 1 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})))
              (ResultOp 2 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]})))
              (ResultOp 3 (Sum (TypedStateSig +PInt64)))
              (ResultOp 4 (Sum (TypedStateSig +PInt64)))
              (ResultOp 5 
                (TakeBy 
                  (TakeByStateSig
                    +PCStruct{locus:+PCLocus(Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa),alleles:+PCArray[+PCString]}
                    +PFloat64)))))
          (Let __iruid_807
            (GetTupleElement 0 (Ref __iruid_802))
            (MakeStruct
              (n (Ref __iruid_807))
              (minkey (GetTupleElement 1 (Ref __iruid_802)))
              (maxkey (GetTupleElement 2 (Ref __iruid_802)))
              (ksorted
                (ApplyComparisonOp EQ
                  (GetTupleElement 3 (Ref __iruid_802))
                  (Ref __iruid_807)))
              (pksorted
                (ApplyComparisonOp EQ
                  (GetTupleElement 4 (Ref __iruid_802))
                  (Ref __iruid_807)))
              (sample (GetTupleElement 5 (Ref __iruid_802))))))
        (NA String))
      (StreamMap __iruid_808
        (StreamFilter __iruid_809
          (StreamMap __iruid_810
            (StreamRange -1 False
              (I32 0)
              (ArrayLen (Ref __iruid_799))
              (I32 1))
            (InsertFields
              (ArrayRef -1 (Ref __iruid_799) (Ref __iruid_810))
              None
              (i (Ref __iruid_810))))
          (ApplyComparisonOp GT
            (ArrayLen (GetField minkey (Ref __iruid_809)))
            (I32 0)))
        (InsertFields
          (Ref __iruid_808)
          None
          (minkey
            (ArrayRef -1
              (GetField minkey (Ref __iruid_808))
              (I32 0)))
          (maxkey
            (ArrayRef -1
              (GetField maxkey (Ref __iruid_808))
              (I32 0))))))
    (ApplyComparisonOp LT
      (SelectFields (minkey maxkey) (Ref __iruid_797))
      (SelectFields (minkey maxkey) (Ref __iruid_798))))
  (MakeStruct
    (ksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_811 __iruid_812
          (ToStream False (Ref __iruid_796))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_811)
            (GetField ksorted (Ref __iruid_812))))
        (StreamFold __iruid_813 __iruid_814
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_796))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_813)
            (ApplyComparisonOp LTEQ
              (GetField maxkey
                (ArrayRef -1 (Ref __iruid_796) (Ref __iruid_814)))
              (GetField minkey
                (ArrayRef -1
                  (Ref __iruid_796)
                  (ApplyBinaryPrimOp Add
                    (Ref __iruid_814)
                    (I32 1)))))))))
    (pksorted
      (ApplySpecial -1 land () Boolean
        (StreamFold __iruid_815 __iruid_816
          (ToStream False (Ref __iruid_796))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_815)
            (GetField pksorted (Ref __iruid_816))))
        (StreamFold __iruid_817 __iruid_818
          (StreamRange -1 False
            (I32 0)
            (ApplyBinaryPrimOp Subtract
              (ArrayLen (Ref __iruid_796))
              (I32 1))
            (I32 1))
          (True)
          (ApplySpecial -1 land () Boolean
            (Ref __iruid_817)
            (ApplyComparisonOp LTEQ
              (SelectFields (locus)
                (GetField maxkey
                  (ArrayRef -1
                    (Ref __iruid_796)
                    (Ref __iruid_818))))
              (SelectFields (locus)
                (GetField minkey
                  (ArrayRef -1
                    (Ref __iruid_796)
                    (ApplyBinaryPrimOp Add
                      (Ref __iruid_818)
                      (I32 1))))))))))
    (sortedPartData (Ref __iruid_796))))
2022-11-01 16:25:13 root: ERROR: error while applying lowering 'LowerOrInterpretNonCompilable'
2022-11-01 16:25:13 root: INFO: RegionPool: FREE: 128.0K allocated (128.0K blocks / 0 chunks), regions.size = 2, 0 current java objects, thread 15: Thread-4
2022-11-01 16:25:13 root: ERROR: RuntimeException: genName has invalid character(s): RGContainer_Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa
From java.lang.RuntimeException: genName has invalid character(s): RGContainer_Users/bencekover/Library/CloudStorage/OneDrive-UniversityCollegeLondon/MSci Bahler lab/S.-Pombe-biofilm/Bence folder/GWAS/Schizosaccharomyces_pombe_all_chromosomes.fa
	at is.hail.lir.package$.genName(package.scala:14)
	at is.hail.asm4s.package$.genName(package.scala:70)
	at is.hail.expr.ir.EmitModuleBuilder.genEmitClass(EmitClassBuilder.scala:30)
	at is.hail.expr.ir.EmitModuleBuilder.$anonfun$getReferenceGenome$1(EmitClassBuilder.scala:56)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitModuleBuilder.getReferenceGenome(EmitClassBuilder.scala:55)
	at is.hail.expr.ir.WrappedEmitModuleBuilder.getReferenceGenome(EmitClassBuilder.scala:81)
	at is.hail.expr.ir.WrappedEmitModuleBuilder.getReferenceGenome$(EmitClassBuilder.scala:81)
	at is.hail.expr.ir.EmitMethodBuilder.getReferenceGenome(EmitClassBuilder.scala:900)
	at is.hail.expr.ir.orderings.LocusOrdering$$anon$1._compareNonnull(LocusOrdering.scala:21)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compareNonnull$1(CodeOrdering.scala:128)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$2(CodeOrdering.scala:100)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1(CodeOrdering.scala:97)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1$adapted(CodeOrdering.scala:95)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrGenEmitMethod$1(EmitClassBuilder.scala:748)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitClassBuilder.getOrGenEmitMethod(EmitClassBuilder.scala:746)
	at is.hail.expr.ir.orderings.CodeOrdering.checkedSCode(CodeOrdering.scala:95)
	at is.hail.expr.ir.orderings.CodeOrdering.compareNonnull(CodeOrdering.scala:128)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$_compare$6(CodeOrdering.scala:191)
	at is.hail.asm4s.CodeBuilderLike.ifx(CodeBuilder.scala:97)
	at is.hail.asm4s.CodeBuilderLike.ifx$(CodeBuilder.scala:88)
	at is.hail.expr.ir.EmitCodeBuilder.ifx(EmitCodeBuilder.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$_compare$4(CodeOrdering.scala:191)
	at is.hail.asm4s.CodeBuilderLike.ifx(CodeBuilder.scala:97)
	at is.hail.asm4s.CodeBuilderLike.ifx$(CodeBuilder.scala:88)
	at is.hail.expr.ir.EmitCodeBuilder.ifx(EmitCodeBuilder.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering._compare(CodeOrdering.scala:191)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compare$1(CodeOrdering.scala:172)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compare$1$adapted(CodeOrdering.scala:172)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$2(CodeOrdering.scala:120)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$1(CodeOrdering.scala:117)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$1$adapted(CodeOrdering.scala:115)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrGenEmitMethod$1(EmitClassBuilder.scala:748)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitClassBuilder.getOrGenEmitMethod(EmitClassBuilder.scala:746)
	at is.hail.expr.ir.orderings.CodeOrdering.checkedEmitCode(CodeOrdering.scala:115)
	at is.hail.expr.ir.orderings.CodeOrdering.compare(CodeOrdering.scala:172)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrderingFunction$1(EmitClassBuilder.scala:511)
	at is.hail.expr.ir.orderings.StructOrdering$$anon$1._compareNonnull(StructOrdering.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compareNonnull$1(CodeOrdering.scala:128)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$2(CodeOrdering.scala:100)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1(CodeOrdering.scala:97)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1$adapted(CodeOrdering.scala:95)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrGenEmitMethod$1(EmitClassBuilder.scala:748)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitClassBuilder.getOrGenEmitMethod(EmitClassBuilder.scala:746)
	at is.hail.expr.ir.orderings.CodeOrdering.checkedSCode(CodeOrdering.scala:95)
	at is.hail.expr.ir.orderings.CodeOrdering.compareNonnull(CodeOrdering.scala:128)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$_compare$6(CodeOrdering.scala:191)
	at is.hail.asm4s.CodeBuilderLike.ifx(CodeBuilder.scala:97)
	at is.hail.asm4s.CodeBuilderLike.ifx$(CodeBuilder.scala:88)
	at is.hail.expr.ir.EmitCodeBuilder.ifx(EmitCodeBuilder.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$_compare$4(CodeOrdering.scala:191)
	at is.hail.asm4s.CodeBuilderLike.ifx(CodeBuilder.scala:97)
	at is.hail.asm4s.CodeBuilderLike.ifx$(CodeBuilder.scala:88)
	at is.hail.expr.ir.EmitCodeBuilder.ifx(EmitCodeBuilder.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering._compare(CodeOrdering.scala:191)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compare$1(CodeOrdering.scala:172)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compare$1$adapted(CodeOrdering.scala:172)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$2(CodeOrdering.scala:120)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$1(CodeOrdering.scala:117)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedEmitCode$1$adapted(CodeOrdering.scala:115)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrGenEmitMethod$1(EmitClassBuilder.scala:748)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitClassBuilder.getOrGenEmitMethod(EmitClassBuilder.scala:746)
	at is.hail.expr.ir.orderings.CodeOrdering.checkedEmitCode(CodeOrdering.scala:115)
	at is.hail.expr.ir.orderings.CodeOrdering.compare(CodeOrdering.scala:172)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrderingFunction$1(EmitClassBuilder.scala:511)
	at is.hail.expr.ir.orderings.StructOrdering$$anon$1._compareNonnull(StructOrdering.scala:38)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$compareNonnull$1(CodeOrdering.scala:128)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$2(CodeOrdering.scala:100)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1(CodeOrdering.scala:97)
	at is.hail.expr.ir.orderings.CodeOrdering.$anonfun$checkedSCode$1$adapted(CodeOrdering.scala:95)
	at is.hail.expr.ir.EmitClassBuilder.$anonfun$getOrGenEmitMethod$1(EmitClassBuilder.scala:748)
	at scala.collection.mutable.HashMap.getOrElseUpdate(HashMap.scala:86)
	at is.hail.expr.ir.EmitClassBuilder.getOrGenEmitMethod(EmitClassBuilder.scala:746)
	at is.hail.expr.ir.orderings.CodeOrdering.checkedSCode(CodeOrdering.scala:95)
	at is.hail.expr.ir.orderings.CodeOrdering.compareNonnull(CodeOrdering.scala:128)
	at is.hail.expr.ir.agg.TakeByRVAS.compareIndexedKey(TakeByAggregator.scala:63)
	at is.hail.expr.ir.agg.TakeByRVAS.$anonfun$compareElt$1(TakeByAggregator.scala:217)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.agg.TakeByRVAS.<init>(TakeByAggregator.scala:215)
	at is.hail.expr.ir.agg.AggStateSig$.getState(Extract.scala:65)
	at is.hail.expr.ir.AggContainer$.$anonfun$fromBuilder$1(Emit.scala:123)
	at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:238)
	at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)
	at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)
	at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:198)
	at scala.collection.TraversableLike.map(TraversableLike.scala:238)
	at scala.collection.TraversableLike.map$(TraversableLike.scala:231)
	at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:198)
	at is.hail.expr.ir.AggContainer$.fromBuilder(Emit.scala:123)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:2053)
	at is.hail.expr.ir.Emit.emitI$3(Emit.scala:2555)
	at is.hail.expr.ir.Emit.$anonfun$emit$22(Emit.scala:2638)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.Emit.emit(Emit.scala:2637)
	at is.hail.expr.ir.Emit.emit$2(Emit.scala:2552)
	at is.hail.expr.ir.Emit.$anonfun$emit$6(Emit.scala:2578)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.Emit.emit(Emit.scala:2577)
	at is.hail.expr.ir.Emit.emitFallback$1(Emit.scala:811)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:2476)
	at is.hail.expr.ir.Emit.$anonfun$emitSplitMethod$1(Emit.scala:591)
	at is.hail.expr.ir.Emit.$anonfun$emitSplitMethod$1$adapted(Emit.scala:589)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedVoid(EmitCodeBuilder.scala:28)
	at is.hail.expr.ir.EmitMethodBuilder.voidWithBuilder(EmitClassBuilder.scala:1007)
	at is.hail.expr.ir.Emit.emitSplitMethod(Emit.scala:589)
	at is.hail.expr.ir.Emit.emitInSeparateMethod(Emit.scala:606)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:793)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:786)
	at is.hail.expr.ir.Emit.$anonfun$emitI$241(Emit.scala:2386)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.Emit.$anonfun$emitI$240(Emit.scala:2386)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.WrappedEmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1058)
	at is.hail.expr.ir.WrappedEmitMethodBuilder.emitWithBuilder$(EmitClassBuilder.scala:1058)
	at is.hail.expr.ir.EmitFunctionBuilder.emitWithBuilder(EmitClassBuilder.scala:1074)
	at is.hail.expr.ir.Emit.$anonfun$emitI$238(Emit.scala:2361)
	at is.hail.expr.ir.IEmitCodeGen.map(Emit.scala:336)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:2341)
	at is.hail.expr.ir.streams.EmitStream$.is$hail$expr$ir$streams$EmitStream$$emit$1(EmitStream.scala:143)
	at is.hail.expr.ir.streams.EmitStream$.$anonfun$produce$3(EmitStream.scala:202)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.streams.EmitStream$.produce(EmitStream.scala:202)
	at is.hail.expr.ir.Emit.emitStream$2(Emit.scala:805)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:1124)
	at is.hail.expr.ir.Emit.emitI$3(Emit.scala:2555)
	at is.hail.expr.ir.Emit.$anonfun$emit$22(Emit.scala:2638)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.Emit.emit(Emit.scala:2637)
	at is.hail.expr.ir.Emit.emit$2(Emit.scala:2552)
	at is.hail.expr.ir.Emit.$anonfun$emit$6(Emit.scala:2578)
	at is.hail.expr.ir.EmitCode$.fromI(Emit.scala:445)
	at is.hail.expr.ir.Emit.emit(Emit.scala:2577)
	at is.hail.expr.ir.Emit.emitFallback$1(Emit.scala:811)
	at is.hail.expr.ir.Emit.emitI(Emit.scala:2476)
	at is.hail.expr.ir.Emit$.$anonfun$apply$5(Emit.scala:78)
	at is.hail.expr.ir.EmitCodeBuilder$.scoped(EmitCodeBuilder.scala:18)
	at is.hail.expr.ir.EmitCodeBuilder$.scopedCode(EmitCodeBuilder.scala:23)
	at is.hail.expr.ir.EmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1005)
	at is.hail.expr.ir.WrappedEmitMethodBuilder.emitWithBuilder(EmitClassBuilder.scala:1058)
	at is.hail.expr.ir.WrappedEmitMethodBuilder.emitWithBuilder$(EmitClassBuilder.scala:1058)
	at is.hail.expr.ir.EmitFunctionBuilder.emitWithBuilder(EmitClassBuilder.scala:1074)
	at is.hail.expr.ir.Emit$.apply(Emit.scala:75)
	at is.hail.expr.ir.Compile$.apply(Compile.scala:78)
	at is.hail.expr.ir.LoweredTableReader$.makeCoercer(TableIR.scala:329)
	at is.hail.expr.ir.GenericTableValue.getLTVCoercer(GenericTableValue.scala:177)
	at is.hail.expr.ir.GenericTableValue.toTableStage(GenericTableValue.scala:202)
	at is.hail.io.vcf.MatrixVCFReader.lower(LoadVCF.scala:1831)
	at is.hail.expr.ir.lowering.LowerTableIR$.applyTable(LowerTableIR.scala:743)
	at is.hail.expr.ir.lowering.LowerTableIR$.lower$1(LowerTableIR.scala:493)
	at is.hail.expr.ir.lowering.LowerTableIR$.apply(LowerTableIR.scala:709)
	at is.hail.expr.ir.lowering.LowerToCDA$.lower(LowerToCDA.scala:73)
	at is.hail.expr.ir.lowering.LowerToCDA$.apply(LowerToCDA.scala:18)
	at is.hail.expr.ir.lowering.LowerToDistributedArrayPass.transform(LoweringPass.scala:77)
	at is.hail.expr.ir.LowerOrInterpretNonCompilable$.evaluate$1(LowerOrInterpretNonCompilable.scala:27)
	at is.hail.expr.ir.LowerOrInterpretNonCompilable$.rewrite$1(LowerOrInterpretNonCompilable.scala:67)
	at is.hail.expr.ir.LowerOrInterpretNonCompilable$.apply(LowerOrInterpretNonCompilable.scala:72)
	at is.hail.expr.ir.lowering.LowerOrInterpretNonCompilablePass$.transform(LoweringPass.scala:69)
	at is.hail.expr.ir.lowering.LoweringPass.$anonfun$apply$3(LoweringPass.scala:16)
	at is.hail.utils.ExecutionTimer.time(ExecutionTimer.scala:81)
	at is.hail.expr.ir.lowering.LoweringPass.$anonfun$apply$1(LoweringPass.scala:16)
	at is.hail.utils.ExecutionTimer.time(ExecutionTimer.scala:81)
	at is.hail.expr.ir.lowering.LoweringPass.apply(LoweringPass.scala:14)
	at is.hail.expr.ir.lowering.LoweringPass.apply$(LoweringPass.scala:13)
	at is.hail.expr.ir.lowering.LowerOrInterpretNonCompilablePass$.apply(LoweringPass.scala:64)
	at is.hail.expr.ir.lowering.LoweringPipeline.$anonfun$apply$1(LoweringPipeline.scala:15)
	at is.hail.expr.ir.lowering.LoweringPipeline.$anonfun$apply$1$adapted(LoweringPipeline.scala:13)
	at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)
	at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)
	at scala.collection.mutable.WrappedArray.foreach(WrappedArray.scala:38)
	at is.hail.expr.ir.lowering.LoweringPipeline.apply(LoweringPipeline.scala:13)
	at is.hail.expr.ir.CompileAndEvaluate$._apply(CompileAndEvaluate.scala:47)
	at is.hail.backend.spark.SparkBackend._execute(SparkBackend.scala:450)
	at is.hail.backend.spark.SparkBackend.$anonfun$executeEncode$2(SparkBackend.scala:486)
	at is.hail.backend.ExecuteContext$.$anonfun$scoped$3(ExecuteContext.scala:70)
	at is.hail.utils.package$.using(package.scala:635)
	at is.hail.backend.ExecuteContext$.$anonfun$scoped$2(ExecuteContext.scala:70)
	at is.hail.utils.package$.using(package.scala:635)
	at is.hail.annotations.RegionPool$.scoped(RegionPool.scala:17)
	at is.hail.backend.ExecuteContext$.scoped(ExecuteContext.scala:59)
	at is.hail.backend.spark.SparkBackend.withExecuteContext(SparkBackend.scala:339)
	at is.hail.backend.spark.SparkBackend.$anonfun$executeEncode$1(SparkBackend.scala:483)
	at is.hail.utils.ExecutionTimer$.time(ExecutionTimer.scala:52)
	at is.hail.backend.spark.SparkBackend.executeEncode(SparkBackend.scala:482)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.GatewayConnection.run(GatewayConnection.java:238)
	at java.lang.Thread.run(Thread.java:750)



2022-11-01 16:26:43 AbstractConnector: INFO: Stopped Spark@44438a6{HTTP/1.1, (http/1.1)}{0.0.0.0:4040}
2022-11-01 16:26:43 SparkUI: INFO: Stopped Spark web UI at http://eduroam-int-dhcp-97-180-2.ucl.ac.uk:4040
2022-11-01 16:26:43 MapOutputTrackerMasterEndpoint: INFO: MapOutputTrackerMasterEndpoint stopped!
2022-11-01 16:26:43 MemoryStore: INFO: MemoryStore cleared
2022-11-01 16:26:43 BlockManager: INFO: BlockManager stopped
2022-11-01 16:26:43 BlockManagerMaster: INFO: BlockManagerMaster stopped
2022-11-01 16:26:43 OutputCommitCoordinator$OutputCommitCoordinatorEndpoint: INFO: OutputCommitCoordinator stopped!
2022-11-01 16:26:43 SparkContext: INFO: Successfully stopped SparkContext
2022-11-01 16:26:43 SparkContext: INFO: SparkContext already stopped.
2022-11-01 16:26:44 SparkContext: INFO: Running Spark version 3.1.3
2022-11-01 16:26:44 ResourceUtils: INFO: ==============================================================
2022-11-01 16:26:44 ResourceUtils: INFO: No custom resources configured for spark.driver.
2022-11-01 16:26:44 ResourceUtils: INFO: ==============================================================
2022-11-01 16:26:44 SparkContext: INFO: Submitted application: Hail
2022-11-01 16:26:44 SparkContext: INFO: Spark configuration:
spark.app.name=Hail
spark.app.startTime=1667320004167
spark.driver.extraClassPath=/Users/bencekover/opt/anaconda3/lib/python3.9/site-packages/hail/backend/hail-all-spark.jar
spark.driver.maxResultSize=0
spark.executor.extraClassPath=./hail-all-spark.jar
spark.hadoop.io.compression.codecs=org.apache.hadoop.io.compress.DefaultCodec,is.hail.io.compress.BGzipCodec,is.hail.io.compress.BGzipCodecTbi,org.apache.hadoop.io.compress.GzipCodec
spark.hadoop.mapreduce.input.fileinputformat.split.minsize=0
spark.jars=file:///Users/bencekover/opt/anaconda3/lib/python3.9/site-packages/hail/backend/hail-all-spark.jar
spark.kryo.registrator=is.hail.kryo.HailKryoRegistrator
spark.kryoserializer.buffer.max=1g
spark.logConf=true
spark.master=local[*]
spark.repl.local.jars=file:///Users/bencekover/opt/anaconda3/lib/python3.9/site-packages/hail/backend/hail-all-spark.jar
spark.serializer=org.apache.spark.serializer.KryoSerializer
spark.submit.deployMode=client
spark.submit.pyFiles=
spark.ui.showConsoleProgress=false
2022-11-01 16:26:44 ResourceProfile: INFO: Default ResourceProfile created, executor resources: Map(cores -> name: cores, amount: 1, script: , vendor: , memory -> name: memory, amount: 1024, script: , vendor: , offHeap -> name: offHeap, amount: 0, script: , vendor: ), task resources: Map(cpus -> name: cpus, amount: 1.0)
2022-11-01 16:26:44 ResourceProfile: INFO: Limiting resource is cpu
2022-11-01 16:26:44 ResourceProfileManager: INFO: Added ResourceProfile id: 0
2022-11-01 16:26:44 SecurityManager: INFO: Changing view acls to: bencekover
2022-11-01 16:26:44 SecurityManager: INFO: Changing modify acls to: bencekover
2022-11-01 16:26:44 SecurityManager: INFO: Changing view acls groups to: 
2022-11-01 16:26:44 SecurityManager: INFO: Changing modify acls groups to: 
2022-11-01 16:26:44 SecurityManager: INFO: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(bencekover); groups with view permissions: Set(); users  with modify permissions: Set(bencekover); groups with modify permissions: Set()
2022-11-01 16:26:44 Utils: INFO: Successfully started service 'sparkDriver' on port 63825.
2022-11-01 16:26:44 SparkEnv: INFO: Registering MapOutputTracker
2022-11-01 16:26:44 SparkEnv: INFO: Registering BlockManagerMaster
2022-11-01 16:26:44 BlockManagerMasterEndpoint: INFO: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2022-11-01 16:26:44 BlockManagerMasterEndpoint: INFO: BlockManagerMasterEndpoint up
2022-11-01 16:26:44 SparkEnv: INFO: Registering BlockManagerMasterHeartbeat
2022-11-01 16:26:44 DiskBlockManager: INFO: Created local directory at /private/var/folders/mb/vdj4y7t13zd3tzlk99b8ycd40000gn/T/blockmgr-49a0d76d-48c2-423b-b3b1-768611716336
2022-11-01 16:26:44 MemoryStore: INFO: MemoryStore started with capacity 366.3 MiB
2022-11-01 16:26:44 SparkEnv: INFO: Registering OutputCommitCoordinator
2022-11-01 16:26:44 Server: INFO: jetty-9.4.40.v20210413; built: 2021-04-13T20:42:42.668Z; git: b881a572662e1943a14ae12e7e1207989f218b74; jvm 1.8.0_351-b10
2022-11-01 16:26:44 Server: INFO: Started @1383131ms
2022-11-01 16:26:44 AbstractConnector: INFO: Started ServerConnector@440167e7{HTTP/1.1, (http/1.1)}{0.0.0.0:4040}
2022-11-01 16:26:44 Utils: INFO: Successfully started service 'SparkUI' on port 4040.
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@5fabc05b{/jobs,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@7411c701{/jobs/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@5580f2fe{/jobs/job,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@316e2b3e{/jobs/job/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@755cd43d{/stages,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@10974984{/stages/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@6a2070c9{/stages/stage,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@159f14a7{/stages/stage/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@70e50407{/stages/pool,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@579b6167{/stages/pool/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@422ff4ab{/storage,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@17a3274a{/storage/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@20da6aec{/storage/rdd,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@4afebaa1{/storage/rdd/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@4e60db02{/environment,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@7ff39e94{/environment/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@7808d388{/executors,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@638f29e2{/executors/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@281aac56{/executors/threadDump,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@6a710ff6{/executors/threadDump/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@41b742b{/static,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@49b2928a{/,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@1fbafeed{/api,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@23133f2a{/jobs/job/kill,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@7101a0c5{/stages/stage/kill,null,AVAILABLE,@Spark}
2022-11-01 16:26:44 SparkUI: INFO: Bound SparkUI to 0.0.0.0, and started at http://eduroam-int-dhcp-97-180-2.ucl.ac.uk:4040
2022-11-01 16:26:44 SparkContext: INFO: Added JAR file:///Users/bencekover/opt/anaconda3/lib/python3.9/site-packages/hail/backend/hail-all-spark.jar at spark://eduroam-int-dhcp-97-180-2.ucl.ac.uk:63825/jars/hail-all-spark.jar with timestamp 1667320004167
2022-11-01 16:26:44 Executor: INFO: Starting executor ID driver on host eduroam-int-dhcp-97-180-2.ucl.ac.uk
2022-11-01 16:26:44 Utils: INFO: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 63827.
2022-11-01 16:26:44 NettyBlockTransferService: INFO: Server created on eduroam-int-dhcp-97-180-2.ucl.ac.uk:63827
2022-11-01 16:26:44 BlockManager: INFO: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2022-11-01 16:26:44 BlockManagerMaster: INFO: Registering BlockManager BlockManagerId(driver, eduroam-int-dhcp-97-180-2.ucl.ac.uk, 63827, None)
2022-11-01 16:26:44 BlockManagerMasterEndpoint: INFO: Registering block manager eduroam-int-dhcp-97-180-2.ucl.ac.uk:63827 with 366.3 MiB RAM, BlockManagerId(driver, eduroam-int-dhcp-97-180-2.ucl.ac.uk, 63827, None)
2022-11-01 16:26:44 BlockManagerMaster: INFO: Registered BlockManager BlockManagerId(driver, eduroam-int-dhcp-97-180-2.ucl.ac.uk, 63827, None)
2022-11-01 16:26:44 BlockManager: INFO: Initialized BlockManager: BlockManagerId(driver, eduroam-int-dhcp-97-180-2.ucl.ac.uk, 63827, None)
2022-11-01 16:26:45 ContextHandler: INFO: Started o.s.j.s.ServletContextHandler@320862c1{/metrics/json,null,AVAILABLE,@Spark}
2022-11-01 16:26:45 Hail: INFO: SparkUI: http://eduroam-int-dhcp-97-180-2.ucl.ac.uk:4040
